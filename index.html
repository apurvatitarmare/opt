
pipeline {
agent {
label  {
label "built-in"
stages  {
stage ('clone')  {

steps {
sh 'git clone https://github.com/apurvatitarmare/opt.git'
}
}
stage ('httpd') {
steps {
sh 'yum install httpd -y'
sh 'systemctl httpd start'
sh 'cp -r /mnt/project/index.html /var/www/html'
sh 'chmod -R 777 var/www/html/index.html'

}
}

stage ('git') {
steps {
sh 'yum install git -y'
sh 'systemctl start'
}

}

stage ('build') {
steps {
sh 'yum install docker -y'
sh 'systemctl start docker'
}

}

stages {
stage ("stage-1")  {
steps {

sh "docker run -itdp 80:80 --name httpd httpd"
 sh "docker cp  httpd:/usr/local/apache2/htdocs/index.html /mnt"
}
}
}


stage ("stage-2")  {
steps {

sh "docker run -itdp 90:80 --name httpd-1 httpd"
 sh "docker cp  httpd-1:/usr/local/apache2/htdocs/index.html /mnt"
}
}

stage ("stage-3")  {
steps {
 
sh "docker run -itdp 8080:80 --name httpd-2 httpd"
sh "docker cp  httpd-2:/usr/local/apache2/htdocs/index.html /mnt"
}
}
}
}
}



















































